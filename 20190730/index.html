<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>When to JavaScript?</title>
    <meta charset="utf-8" />
    <meta name="author" content="Carson Sievert, PhD   Software Engineer, RStudio" />
    <link href="index_files/font-awesome-5.3.1/css/fontawesome-all.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">

class: middle, center, inverse

# Why JavaScript?

### Carson Sievert, PhD &lt;br/&gt; Software Engineer, RStudio

### Slides: http://bit.ly/jsm_19

### <i class="fab  fa-twitter "></i> &lt;a href='https://twitter.com/cpsievert'&gt;@cpsievert&lt;/a&gt; &lt;br/&gt; <i class="fas  fa-globe "></i> &lt;https://cpsievert.me&gt; &lt;br/&gt; <i class="fas  fa-envelope "></i> &lt;cpsievert1@gmail.com&gt;

---
background-image: url(karl-moustache.jpg)
background-size: contain
class: huge-font

&lt;font color = "#005DAA"&gt;Mo&lt;/font&gt; &lt;font color = "white"&gt;us&lt;/font&gt; &lt;font color = "#005DAA"&gt;t&lt;/font&gt; &lt;font color = "white"&gt;ach&lt;/font&gt; &lt;font color = "#005DAA"&gt;ivation&lt;/font&gt;

---
class: middle, center, inverse

&lt;font color="#BF0F0F" style="font-size:2em;position:absolute;top:75px;left:340px"&gt;Why not&lt;/font&gt;
&lt;img src="crossout.png" width="100px" style="position:absolute;top:130px;left:340px" /&gt;

# Why JavaScript?

### Carson Sievert, PhD &lt;br/&gt; Software Engineer, RStudio

### Slides: http://bit.ly/jsm_19

### <i class="fab  fa-twitter "></i> &lt;a href='https://twitter.com/cpsievert'&gt;@cpsievert&lt;/a&gt; &lt;br/&gt; <i class="fas  fa-globe "></i> &lt;https://cpsievert.me&gt; &lt;br/&gt; <i class="fas  fa-envelope "></i> &lt;cpsievert1@gmail.com&gt;

---
class: middle, center, inverse

&lt;font color="#BF0F0F" style="font-size:2em;position:absolute;top:75px;left:340px"&gt;When to&lt;/font&gt;
&lt;img src="crossout.png" width="100px" style="position:absolute;top:130px;left:340px" /&gt;

# Why JavaScript?

### Carson Sievert, PhD &lt;br/&gt; Software Engineer, RStudio

### Slides: http://bit.ly/jsm_19

### <i class="fab  fa-twitter "></i> &lt;a href='https://twitter.com/cpsievert'&gt;@cpsievert&lt;/a&gt; &lt;br/&gt; <i class="fas  fa-globe "></i> &lt;https://cpsievert.me&gt; &lt;br/&gt; <i class="fas  fa-envelope "></i> &lt;cpsievert1@gmail.com&gt;

---
class: middle

## "Of course someone has to write for loops. &lt;br&gt; It doesn‚Äôt have to be you."

- Jenny Bryan (Software Engineer, RStudio)



---
class: middle

&lt;img src="crossout.png" width="150px" style="position:absolute;top:255px;right:125px" /&gt;

&lt;font color="#BF0F0F" style="font-size:2em;position:absolute;top:205px;right:125px"&gt;JavaScript&lt;/font&gt;

## "Of course someone has to write for loops. It doesn‚Äôt have to be you."

- Me, for similar reasons

---
class: middle

&lt;img src="crossout.png" width="150px" style="position:absolute;top:255px;right:575px" /&gt;

&lt;font color="#BF0F0F" style="font-size:2em;position:absolute;top:205px;right:475px"&gt;JavaScript&lt;/font&gt;

## Why avoid for loops?

&gt; &lt;font style='font-size:1.5em'&gt; "It is all too easy for statistical thinking to be swamped by programming tasks." &lt;/font&gt; (Brian D. Ripley)

---

## What does this R code do?

&lt;pre&gt;&lt;code&gt;
out1 &lt;- vector("double", ncol(mtcars))
for (i in seq_along(mtcars)) {
  out1[[i]] &lt;- mean(mtcars[[i]], na.rm = TRUE)
}

out2 &lt;- vector("double", ncol(mtcars))
for (i in seq_along(mtcars)) {
  out2[[i]] &lt;- median(mtcars[[i]], na.rm = TRUE)
}
&lt;/code&gt;&lt;/pre&gt;


.footnote[
Example from Hadley Wickham's _Building Tidy Tools_ [workshop](https://blog.rstudio.com/2019/02/06/rstudio-conf-2019-workshops/).
]

---

## For loops emphasize the objects

&lt;pre&gt;&lt;code&gt;
&lt;font color="red"&gt;out1&lt;/font&gt; &lt;- vector("double", &lt;font color="red"&gt;ncol(mtcars)&lt;/font&gt;)
for (i in seq_along(&lt;font color="red"&gt;mtcars&lt;/font&gt;)) {
  &lt;font color="red"&gt;out1[[i]]&lt;/font&gt; &lt;- mean(&lt;font color="red"&gt;mtcars[[i]]&lt;/font&gt;, na.rm = TRUE)
}

&lt;font color="red"&gt;out2&lt;/font&gt; &lt;- vector("double", &lt;font color="red"&gt;ncol(mtcars))&lt;/font&gt;
for (i in seq_along(&lt;font color="red"&gt;mtcars&lt;/font&gt;)) {
  &lt;font color="red"&gt;out2[[i]]&lt;/font&gt; &lt;- median(&lt;font color="red"&gt;mtcars[[i]]&lt;/font&gt;, na.rm = TRUE)
}
&lt;/code&gt;&lt;/pre&gt;

.footnote[
Example from Hadley Wickham's _Building Tidy Tools_ [workshop](https://blog.rstudio.com/2019/02/06/rstudio-conf-2019-workshops/).
]

---

## Not the actions

&lt;pre&gt;&lt;code&gt;
out1 &lt;- vector("double", ncol(mtcars))
for (i in seq_along(mtcars)) {
  out1[[i]] &lt;- &lt;font color="red"&gt;mean&lt;/font&gt;(mtcars[[i]], na.rm = TRUE)
}

out2 &lt;- vector("double", ncol(mtcars))
for (i in seq_along(mtcars)) {
  out2[[i]] &lt;- &lt;font color="red"&gt;median&lt;/font&gt;(mtcars[[i]], na.rm = TRUE)
}
&lt;/code&gt;&lt;/pre&gt;

.footnote[
Example from Hadley Wickham's _Building Tidy Tools_ [workshop](https://blog.rstudio.com/2019/02/06/rstudio-conf-2019-workshops/).
]

---

## Functional programming weights equally


&lt;pre&gt;&lt;code&gt;
library(purrr)
means &lt;- map_dbl(&lt;font color="red"&gt;mtcars&lt;/font&gt;, &lt;font color="red"&gt;mean&lt;/font&gt;)
medians &lt;- map_dbl(&lt;font color="red"&gt;mtcars&lt;/font&gt;, &lt;font color="red"&gt;median&lt;/font&gt;)
&lt;/code&gt;&lt;/pre&gt;

.footnote[
Example from Hadley Wickham's _Building Tidy Tools_ [workshop](https://blog.rstudio.com/2019/02/06/rstudio-conf-2019-workshops/).
]


---

## Functional programming weights equally


&lt;pre&gt;&lt;code&gt;
library(purrr)
means &lt;- map_dbl(&lt;font color="red"&gt;mtcars&lt;/font&gt;, &lt;font color="red"&gt;mean&lt;/font&gt;)
medians &lt;- map_dbl(&lt;font color="red"&gt;mtcars&lt;/font&gt;, &lt;font color="red"&gt;median&lt;/font&gt;)
&lt;/code&gt;&lt;/pre&gt;

### For more, see ["The Joy of Functional Programming (for Data Science)"](https://www.youtube.com/watch?v=bzUmK0Y07ck) by Hadley Wickham

.footnote[
Example from Hadley Wickham's _Building Tidy Tools_ [workshop](https://blog.rstudio.com/2019/02/06/rstudio-conf-2019-workshops/).
]

---

&lt;font color="#BF0F0F" style="font-size:2em; position:absolute; top:20px; left:100px"&gt;JavaScript&lt;/font&gt;

&lt;img src="crossout.png" width="140px" style="position:absolute;top:65px;left:100px" /&gt;
## For loop emphasizes objects 

&lt;br&gt;
&lt;br&gt;
&lt;br&gt;

### JavaScript: a language for manipulating the Document **Object** Model (DOM)!

* &lt;font style="font-size:1.5em"&gt;D3: easier to map data to the DOM, but you're still &lt;i&gt;working with a low-level graphics API&lt;/i&gt; (e.g., HTML, SVG, CSS, etc)&lt;/font&gt;
  
---
class: small-code

### 'High-level' JS libraries

&lt;div align="center"&gt;
  &lt;img src="bars.png" height="250" /&gt;
&lt;/div&gt;

.pull-left[
```html
&lt;html&gt;
  &lt;script src="https://cdn.plot.ly/plotly-latest.min.js"&gt;&lt;/script&gt;
  &lt;body&gt;
    &lt;div id="graph"&gt;&lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
```
]

.pull-right[
```javascript
var bar = {
  x: [1, 2, 3],
  y: ["a", "b", "c"],
  type: "bar"
}
Plotly.plot("graph", {data: [bar]})
```
]

---
class:small-code
### 'High-level' JS libraries

- &lt;font style="font-size:1.5em"&gt; üëç Compared to D3, more weight on the domain problem&lt;/font&gt;
* &lt;font style="font-size:1.5em"&gt; üëé HTML boilerplate&lt;/font&gt;
- &lt;font style="font-size:1.5em"&gt; üëé Web tech is not designed for data exploration, &lt;b&gt;but R is!&lt;/b&gt; &lt;/font&gt;

&lt;br/&gt;

.pull-left[
```html
&lt;html&gt;
  &lt;script src="https://cdn.plot.ly/plotly-latest.min.js"&gt;&lt;/script&gt;
  &lt;body&gt;
    &lt;div id="graph"&gt;&lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
```
]

.pull-right[
```javascript
var bar = {
  x: [1, 2, 3],
  y: ["a", "b", "c"],
  type: "bar"
}
Plotly.plot("graph", {data: [bar]})
```
]


---
background-image: url(why-not-both2.gif)
background-size: contain



---
### htmlwidgets: a bridge between R and JS libraries

&lt;a href="http://gallery.htmlwidgets.org"&gt;
  &lt;img src="htmlwidgets.png" width="100%" /&gt;
&lt;/a&gt;


---
class: small-code

### htmlwidgets: computing+graphics synergy

```r
library(plotly)
albersusa::usa_sf("laea") %&gt;% 
  cartogram::cartogram_cont("pop_2014") %&gt;%
  plot_ly(us_cont) %&gt;% 
  add_sf(color = ~pop_2014, split = ~name, span = I(1), text = ~paste(name, scales::number_si(pop_2014))) %&gt;%
  colorbar(title = "Population \n 2014")
```

&lt;div align="center"&gt;
  &lt;img src="cartogram.png" height=400 /&gt;
&lt;/div&gt;

---
class: small-code

### htmlwidgets: *within view* interaction for 'free'

```r
library(plotly)
plot_ly(diamonds, x = ~cut, color = ~clarity, colors = "Accent")
```

&lt;img src="within-view.gif" width="100%" /&gt;

---
### What about "non-standard interaction"?

&lt;img src="hyperlink.gif" width="100%" /&gt;

---
class: small-code

### Time to JavaScript!

```r
plot_ly(mtcars, x = ~wt, y = ~mpg) %&gt;%
  add_markers(
    customdata = paste0(
      "http://google.com/#q=", rownames(mtcars)
    )
  ) %&gt;%
  htmlwidgets::onRender("
    function(el) {
*      el.on('plotly_click', function(d) {
*        var url = d.points[0].customdata;
*        window.open(url);
*      });
    }
  ")
```

### Learn more about registering custom JavaScript events with **plotly** -- &lt;https://plotly-r.com/javascript.html&gt;

---
### What about *across view* interaction?

&lt;img src="zikar.gif" width="100%" /&gt;

---
class: small-code

### Time to shiny (and _maybe_ JavaScript?)

Most **htmlwidgets** allow you to access user events in **shiny**

.pull-left[
```r
library(shiny)
ui &lt;- fluidPage(
  plotlyOutput("p"),
  verbatimTextOutput("click")
)
server &lt;- function(input, output) {
  output$p &lt;- renderPlotly({
    plot_ly(mtcars, x = ~wt, y = ~mpg)
  })
  output$click &lt;- renderPrint({
*    event_data("plotly_click")
  })
}
shinyApp(ui, server)
```
]

.pull-right[
&lt;img src="event.gif"/&gt;
]

---

### shiny itself isn't slow, your R code is!

&lt;img src="cross.gif"width="100%" /&gt;

---
class: large-font

## In summary
  
* Programming in JavaScript, like for loops, can distract from the main task/action.
    * Over-emphasis on objects that are far removed from your domain problem

* R bindings to JS libs (i.e., htmlwidgets, shiny, etc), best of both worlds!
  * If you hit a dead-end with these tools, *then it's time to learn JavaScript*!
  
---
class: middle, center, inverse, large-font

## Thank you!


### Slides &lt;https://bit.ly/jsm_19&gt; &lt;br&gt;
### <i class="fab  fa-twitter "></i> &lt;a href="https://twitter.com/cpsievert"&gt;@cpsievert&lt;/a&gt; &lt;br&gt;
### <i class="fas  fa-envelope "></i> &lt;cpsievert1@gmail.com&gt; &lt;br&gt;
### <i class="fas  fa-globe "></i> &lt;https://cpsievert.me/&gt;
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="../templates/remarkjs/libs/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"ratio": "14.6:9",
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"navigation": {
"scroll": false
}
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
